# scRNA-seq Pre-processing Workflow

This repository outlines a comprehensive workflow for pre-processing single-cell RNA sequencing (scRNA-seq) data using Seurat v5. The workflow covers all steps from package installation to quality control (QC) of the Seurat object.

---

## Table of Contents

- [Background](#background)
- [Objectives](#objectives)
- [Workflow Summary](#workflow-summary)
- [How to Run](#how-to-run)
- [Requirements](#requirements)
- [License](#license)

---

## Background

Whole-transcriptome technologies like microarrays and RNA-Seq provide rich gene expression profiles across tissues and timepoints. Traditional analyses often focus on identifying differentially expressed genes (DEGs) between predefined groups. However, such approaches typically overlook the complex interconnections between genes and the heterogeneity within sample groups.

Identifying genes with correlated expression patterns can reveal shared biological functions or regulatory relationships. Similarly, investigating sample-to-sample heterogeneity is crucial for detecting outliers or hidden subgroups, which, if unaddressed, can bias differential gene expression analyses.

---

## Objectives

- Capture hidden structures within the dataset using **UMAP** for dimensionality reduction and **k-means clustering**.
- Uncover sample heterogeneity and potential subgroups missed by standard group-based comparisons.
- Integrate clustering results into a **weighted gene co-expression network analysis (WGCNA)** to explore gene networks associated with sample groups.

---

## Workflow Summary

1. **Data Loading:**
   - Load data generated from the SevenBridge pipeline (.Rds files).
   - Merge data into a Seurat object list using the `Merge_Seurat_List` function in Seurat.

2. **Quality Control and Filtering:**
   - Evaluate essential QC metrics generated by Seurat:
     - **nCount_RNA:** Total UMIs per cell. High counts may indicate multiplets, while low counts suggest droplets without actual cells.
     - **nFeature_RNA:** Number of unique genes detected per cell. Few detected genes typically signify poor-quality captures.
     - **Mitochondrial Gene Percentage:** Elevated mitochondrial gene expression typically characterizes damaged or dying cells. However, cell types like cardiomyocytes inherently express high mitochondrial genes, thus requiring careful consideration.
     - **Ribosomal Gene Percentage:** High ribosomal gene counts can vary across cell types and indicate the translational activity of cells.
     - **Cell Cycle Scoring:** Using established marker genes provided by Seurat, classify cells into G1, S, or G2M phases to assess cell cycle effects.
   - Determine filtering criteria based on QC metrics, e.g., library size thresholds, number of expressed genes, and mitochondrial or spike-in gene proportions.

3. **Normalization, Scaling & Variable Feature Selection:**
   - Normalize raw count data using Seuratâ€™s default normalization method: scaling counts by total counts per cell, multiplying by 10,000, and performing a log transformation.
   - Scale data and identify variable features to prepare for downstream analysis.

4. **Dimensionality Reduction:**
   - Conduct principal component analysis (PCA) or other dimensionality reduction techniques to simplify data visualization and exploration.

5. **Clustering:**
   - Identify distinct cell populations within the dataset through clustering algorithms.

6. **Marker Identification:**
   - Identify gene markers that characterize and define each cluster.

7. **Validation of Clusters and Markers:**
   - Assess the robustness and biological relevance of identified clusters and marker genes.

This combined strategy ensures rigorous and reproducible pre-processing for robust downstream scRNA-seq analyses.

---

## How to Run

1. **Clone the Repository:**

   ```bash
   git clone https://github.com/yourusername/scrna-seq-analysis.git
   cd scrna-seq-analysis
   ```

2. **Set Up the Environment:**

   Install the required R packages:

   ```r
   install.packages(c("Seurat", "dplyr", "ggplot2", "Matrix"))
   ```

3. **Execute Scripts:**

   Follow the numbered order in the `/scripts/` directory to sequentially execute each analysis step.

4. **View Results:**

   All output figures and tables will be saved in the `/results/` directory.

---

## Requirements

- R >= 4.2.0
- Packages:
  - **Seurat**
  - **dplyr**
  - **ggplot2**
  - **Matrix**



